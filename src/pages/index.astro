---
import Layout from '../layouts/Layout.astro';
import ImgLeft from '../components/imgLeft.astro';
import ImgRight from '../components/imgRight.astro';
import ImgFull from '../components/imgFull.astro';
import ProjectDescrizione from '../components/projectDescrizione.astro';
---

<Layout title="Welcome to Astro." language=''>
    <img src="/logo-2.svg" alt="Logo" class="px-2 pt-1" loading="lazy">
    <a href="/soy" class="text-6xl text-rosso mt-6">Soy</a>
    <h1 class="text-6xl text-rosso fixed">Raw Scenarios</h1>

    <!-- Add images with classes for CSS effects -->
    <div class="images-container">
        <img src="/assets/immagini/avocado.png" alt="avocado" class="threshold" data-x="150" data-y="-10" data-scale="0.4" data-angle="0">
        <img src="/assets/immagini/caffe.png" alt="caffe" class="threshold" data-x="1210" data-y="-550" data-scale="0.55" data-angle="0">
        <img src="/assets/immagini/gambero.png" alt="gambero" class="threshold" data-x="900" data-y="150" data-scale="0.6" data-angle="0">
        <img src="/assets/immagini/patata.png" alt="patata" class="threshold" data-x="1450" data-y="-300" data-scale="0.3" data-angle="0">
        <img src="/assets/immagini/pomodoro.png" alt="pomodoro" class="threshold" data-x="700" data-y="-50" data-scale="0.55" data-angle="0">
        <img src="/assets/immagini/riso.png" alt="riso" class="threshold" data-x="1490" data-y="-550" data-scale="0.5" data-angle="0">
        <img src="/assets/immagini/salmone.png" alt="salmone" class="threshold" data-x="-300" data-y="-550" data-scale="0.6" data-angle="0">
        <img src="/assets/immagini/soia.png" alt="soia" class="threshold" data-x="600" data-y="-600" data-scale="0.6" data-angle="0">
        <img src="/assets/immagini/tonno.png" alt="tonno" class="threshold" data-x="-40" data-y="-250" data-scale="0.65" data-angle="0">
        <img src="/assets/immagini/zucchero.png" alt="zucchero" class="threshold" data-x="100" data-y="-270" data-scale="0.45" data-angle="0">
        <img src="/assets/immagini/mais.png" alt="mais" class="threshold" data-x="1100" data-y="-480" data-scale="0.6" data-angle="-70">
    </div>
</Layout>

<style>
  body {
    margin: 0;
    overflow: hidden;
  }
  .images-container {
    position: relative;
    width: 100vw;
    height: 100vh;
    z-index: -1; 
  }
  .threshold {
    filter: brightness(110%) contrast(200%);
    opacity: 30%;
    transition: filter var(--transition-duration, 0.2s) ease-out;
    position: absolute;
    transform: scale(var(--scale)) rotate(var(--angle));
    width: auto;
    height: auto;
  }
  img, a, h1 {
    position: relative; 
    z-index: 1;
  }
</style>

<script>
  function adjustImagePositions() {
    const images = document.querySelectorAll('.threshold');
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;

    images.forEach((img) => {
      const imgElement = img as HTMLElement;
      const x = parseInt(imgElement.dataset.x ?? "0", 10);
      const y = parseInt(imgElement.dataset.y ?? "0", 10);
      const scale = parseFloat(imgElement.dataset.scale ?? "1");
      const angle = parseInt(imgElement.dataset.angle ?? "0", 10);

      const relativeX = (x / 1920) * viewportWidth; // assuming 1920 is the original width
      const relativeY = Math.min((y / 1080) * viewportHeight, viewportHeight - 100); // assuming 1080 is the original height

      imgElement.style.left = `${relativeX}px`;
      imgElement.style.top = `${relativeY}px`;

      const adjustedScale = scale * Math.min(viewportWidth / 1920, viewportHeight / 1080);
      imgElement.style.transform = `scale(${adjustedScale}) rotate(${angle}deg)`;
    });
  }

  document.addEventListener('mousemove', (event) => {
    const images = document.querySelectorAll('.threshold');

    images.forEach((img) => {
      const imgElement = img as HTMLElement;
      const rect = imgElement.getBoundingClientRect();
      const imgCenterX = rect.left + rect.width / 2;
      const imgCenterY = rect.top + rect.height / 2;

      const distX = Math.abs(event.clientX - imgCenterX);
      const distY = Math.abs(event.clientY - imgCenterY);
      const maxDist = Math.sqrt(rect.width * rect.width + rect.height * rect.height) / 2;
      const distance = Math.sqrt(distX * distX + distY * distY);

      const threshold = Math.max(0, (1 - distance / maxDist) * 100);

      imgElement.style.setProperty('--threshold', `${threshold}%`);
      const brightness = 110 - (threshold * 0.4); // Decrease brightness from 110% to 70%
      const contrast = 200 + (threshold * 2); // Increase contrast from 200% to 400%
      imgElement.style.filter = `brightness(${brightness}%) contrast(${contrast}%)`;
    });
  });

  window.addEventListener('resize', adjustImagePositions);
  window.addEventListener('load', adjustImagePositions);
</script>





<!-- 
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js" integrity="sha384-DNa3EMEwCbXdWesI58M+KapvoPndaEq/H61SjvIbqhxlLG0vGzqAF3htFLNBL+Z2" crossorigin="anonymous" is:inline defer></script>
<script src="/p5/sketch.min.js" is:inline defer></script>

<style>
  body {
    margin: 0;
    overflow: hidden;
  }
  canvas {
    position: absolute;
    top: 0;
    left: 0;
    z-index: -1;
  }
</style>
-->
